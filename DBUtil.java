[UPDATED FILE CONTENT WITH SECURITY FIXES]